From 429213df23ed282971077b2668f62e41731c8713 Mon Sep 17 00:00:00 2001
From: Kovid Goyal <kovid@kovidgoyal.net>
Date: Tue, 16 Jun 2020 09:41:09 +0530
Subject: [PATCH 143/423] Order FTS results by rank

---
 src/calibre/db/backend.py | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/calibre/db/backend.py b/src/calibre/db/backend.py
index 9bb48530af..66df3a7e14 100644
--- a/src/calibre/db/backend.py
+++ b/src/calibre/db/backend.py
@@ -1799,6 +1799,7 @@ class DB(object):
         if annotation_type:
             query += ' AND annotations.annot_type = ? '
             data.append(annotation_type)
+        query += ' ORDER BY {}.rank '.format(fts_table)
         try:
             for (rowid, book_id, fmt, user_type, user, annot_data, text) in self.execute(query, tuple(data)):
                 yield {
-- 
2.28.0

