From 0fd2b59dc37d5ecae49815d6dc6875790839898a Mon Sep 17 00:00:00 2001
From: Kovid Goyal <kovid@kovidgoyal.net>
Date: Mon, 27 Jul 2020 19:33:25 +0530
Subject: [PATCH 266/284] Show the highlight and lookup actions if the
 selection bar is disabled

---
 src/pyj/read_book/overlay.pyj | 20 ++++++++++++--------
 1 file changed, 12 insertions(+), 8 deletions(-)

diff --git a/src/pyj/read_book/overlay.pyj b/src/pyj/read_book/overlay.pyj
index 6d59e2cd61..c331ab4a2d 100644
--- a/src/pyj/read_book/overlay.pyj
+++ b/src/pyj/read_book/overlay.pyj
@@ -314,15 +314,18 @@ class MainOverlay:  # {{{
         if full_screen_actions.length:
             actions_div.appendChild(E.ul(*full_screen_actions))
 
-        highlight_action = ac(_('Highlight'), _('Highlight text in the book'),
-                def(): self.overlay.hide(), self.overlay.view.initiate_create_annotation();, 'highlight')
+        no_selection_bar = not sd.get('show_selection_bar')
+        if no_selection_bar:
+            highlight_action = ac(_('Highlight'), _('Highlight text in the book'),
+                    def(): self.overlay.hide(), self.overlay.view.initiate_create_annotation();, 'highlight')
 
         if runtime.is_standalone_viewer:
-            actions_div.appendChild(E.ul(
-                ac(_('Lookup/search word'), _('Lookup or search for the currently selected word'),
-                   def(): self.overlay.hide(), ui_operations.toggle_lookup(True);, 'library')
-            ))
-            actions_div.lastChild.appendChild(highlight_action)
+            if no_selection_bar:
+                actions_div.appendChild(E.ul(
+                    ac(_('Lookup/search word'), _('Lookup or search for the currently selected word'),
+                    def(): self.overlay.hide(), ui_operations.toggle_lookup(True);, 'library')
+                ))
+                actions_div.lastChild.appendChild(highlight_action)
             actions_div.lastChild.appendChild(
                 ac(_('Browse highlights'), _('Browse all highlights'),
                     def(): self.overlay.hide(), ui_operations.toggle_highlights();, 'image')
@@ -351,7 +354,8 @@ class MainOverlay:  # {{{
                    def(): self.overlay.hide(), ui_operations.quit();, 'remove'),
             ))
         else:
-            actions_div.appendChild(E.ul(highlight_action))
+            if no_selection_bar:
+                actions_div.appendChild(E.ul(highlight_action))
         container.appendChild(set_css(E.div(class_=MAIN_OVERLAY_TS_CLASS,  # top section
             onclick=def (evt):evt.stopPropagation();,
 
-- 
2.28.0

