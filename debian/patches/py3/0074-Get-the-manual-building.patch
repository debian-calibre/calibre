From a3615ec44c30f92468db8605c7898b00784ca49d Mon Sep 17 00:00:00 2001
From: Kovid Goyal <kovid@kovidgoyal.net>
Date: Thu, 12 Dec 2019 18:00:03 +0530
Subject: [PATCH 074/423] Get the manual building

---
 manual/build.py      | 2 +-
 manual/custom.py     | 2 +-
 src/calibre/linux.py | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/manual/build.py b/manual/build.py
index 76924420ac..6c1f3cd441 100755
--- a/manual/build.py
+++ b/manual/build.py
@@ -11,7 +11,7 @@ from functools import partial
 
 j, d, a = os.path.join, os.path.dirname, os.path.abspath
 BASE = d(a(__file__))
-SPHINX_BUILD = 'sphinx-build2'
+SPHINX_BUILD = 'sphinx-build'
 
 sys.path.insert(0, d(BASE))
 from setup import __appname__, __version__
diff --git a/manual/custom.py b/manual/custom.py
index 2170166ca3..26af36a67b 100644
--- a/manual/custom.py
+++ b/manual/custom.py
@@ -33,7 +33,7 @@ def source_read_handler(app, docname, source):
     # Sphinx does not call source_read_handle for the .. include directive
     for m in reversed(tuple(include_pat.finditer(src))):
         included_doc_name = m.group(1).lstrip('/')
-        ss = [open(included_doc_name).read().decode('utf-8')]
+        ss = [open(included_doc_name, 'rb').read().decode('utf-8')]
         source_read_handler(app, included_doc_name.partition('.')[0], ss)
         src = src[:m.start()] + ss[0] + src[m.end():]
     source[0] = src
diff --git a/src/calibre/linux.py b/src/calibre/linux.py
index 7f6dc6036f..453c03d195 100644
--- a/src/calibre/linux.py
+++ b/src/calibre/linux.py
@@ -22,7 +22,7 @@ entry_points = {
              'ebook-meta           = calibre.ebooks.metadata.cli:main',
              'ebook-convert        = calibre.ebooks.conversion.cli:main',
              'ebook-polish         = calibre.ebooks.oeb.polish.main:main',
-             'markdown-calibre     = calibre.ebooks.markdown.__main__:run',
+             'markdown-calibre     = markdown.__main__:run',
              'web2disk             = calibre.web.fetch.simple:main',
              'calibre-server       = calibre.srv.standalone:main',
              'lrf2lrs              = calibre.ebooks.lrf.lrfparser:main',
-- 
2.28.0

