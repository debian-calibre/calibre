From 0ae9dea8f4a4965011872faa691296e962a867c0 Mon Sep 17 00:00:00 2001
From: Kovid Goyal <kovid@kovidgoyal.net>
Date: Mon, 3 Aug 2020 19:32:27 +0530
Subject: [PATCH 296/408] Fix editor being closed on resize

---
 src/pyj/read_book/selection_bar.pyj | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

diff --git a/src/pyj/read_book/selection_bar.pyj b/src/pyj/read_book/selection_bar.pyj
index b9719446b3..9a1b59c8e5 100644
--- a/src/pyj/read_book/selection_bar.pyj
+++ b/src/pyj/read_book/selection_bar.pyj
@@ -500,16 +500,19 @@ class SelectionBar:
 
     def update_position(self):
         container = self.container
+        cs = self.view.currently_showing.selection
         self.bar.style.display = 'none'
-        self.editor.style.display = 'none'
         self.set_handle_colors()
         if self.state is DRAGGING:
             self.show()
             return
+        if self.state is EDITING:
+            self.show()
+            return
         self.left_handle.style.display = 'none'
         self.right_handle.style.display = 'none'
+        self.editor.style.display = 'none'
 
-        cs = self.view.currently_showing.selection
         if not cs or cs.empty or jstype(cs.drag_mouse_position.x) is 'number':
             return self.hide()
 
@@ -522,8 +525,6 @@ class SelectionBar:
             return {'x': (x.x or 0) + margins.left, 'y': (x.y or 0) + margins.top, 'height': x.height or 0, 'onscreen': x.onscreen}
 
         self.show()
-        if self.state is EDITING:
-            return
         self.bar.style.display = self.left_handle.style.display = self.right_handle.style.display = 'block'
         start = map_boundary(cs.start)
         end = map_boundary(cs.end)
-- 
2.28.0

