From: Dmitry Shachnev <mitya57@gmail.com>
Date: Mon, 14 Nov 2016 22:41:23 +0100
Subject: Do not build unrar extension as we strip unrar from the tarball

---
 setup/extensions.py                    | 18 ------------------
 src/calibre/ebooks/metadata/archive.py |  2 +-
 2 files changed, 1 insertion(+), 19 deletions(-)

diff --git a/setup/extensions.py b/setup/extensions.py
index 6a6d6f2..a634f76 100644
--- a/setup/extensions.py
+++ b/setup/extensions.py
@@ -244,24 +244,6 @@ extensions = [
                 sip_files=['calibre/ebooks/pdf/render/qt_hack.sip']
                 ),
 
-    Extension('unrar',
-              ['unrar/%s.cpp'%(x.partition('.')[0]) for x in '''
-               rar.o strlist.o strfn.o pathfn.o savepos.o smallfn.o global.o file.o
-               filefn.o filcreat.o archive.o arcread.o unicode.o system.o
-               isnt.o crypt.o crc.o rawread.o encname.o resource.o match.o
-               timefn.o rdwrfn.o consio.o options.o ulinks.o errhnd.o rarvm.o
-               secpassword.o rijndael.o getbits.o sha1.o extinfo.o extract.o
-               volume.o list.o find.o unpack.o cmddata.o filestr.o scantree.o
-               '''.split()] + ['calibre/utils/unrar.cpp'],
-              inc_dirs=['unrar'],
-              cflags=[('/' if iswindows else '-') + x for x in (
-                  'DSILENT', 'DRARDLL', 'DUNRAR')] + (
-                  [] if iswindows else ['-D_FILE_OFFSET_BITS=64',
-                                        '-D_LARGEFILE_SOURCE']),
-              optimize_level=2,
-              libraries=['User32', 'Advapi32', 'kernel32', 'Shell32'] if iswindows else []
-              ),
-
     ]
 
 
diff --git a/src/calibre/ebooks/metadata/archive.py b/src/calibre/ebooks/metadata/archive.py
index 96fc0de..9071531 100644
--- a/src/calibre/ebooks/metadata/archive.py
+++ b/src/calibre/ebooks/metadata/archive.py
@@ -42,7 +42,7 @@ class ArchiveExtract(FileTypePlugin):
     description = _('Extract common e-book formats from archives '
         '(zip/rar) files. Also try to autodetect if they are actually '
         'cbz/cbr files.')
-    file_types = set(['zip', 'rar'])
+    file_types = set(['zip'])
     supported_platforms = ['windows', 'osx', 'linux']
     on_import = True
 
